Настройка доменов
=================

.. contents::
    :local:
    :backlinks: top

Введение
--------
Если Вы являетесь менеджером домена в Mailtank, Вам необходимо настроить DNS записи домена.  Проекты в Mailtank не смогут посылать рассылки, если их e-mail адреса относятся к домену, который не прошел проверку. Mailtank проверяет DKIM и SPF записи каждый час.

SPF
---
Sender Policy Framework (структура политики отправителя) — расширение для протокола отправки электронной почты через SMTP. SPF определен в RFC 4408.
Благодаря SPF можно проверить, не подделан ли домен отправителя

Для того, чтобы серверы Mailtank могли посылать почту от имени Вашего домена, необходимо включить их в список разрешенных серверов.

Настройка SPF записи домена
+++++++++++++++++++++++++++
SPF запись является специально сформированной строкой в "TXT" записях домена. Чтобы разрешить Mailtank отправлять письма с Вашего домена, нужно добавить механизм "include:mailtank.ru" в строку SPF. Если в Вашей SPF записи есть механизмы "redirect" или "all", то они должны идти после "include:mailtank.ru".

Примеры правильно настроенной SPF записи:

.. sourcecode:: txt

    v=spf1 include:mailtank.ru +a +mx -all

.. sourcecode:: txt

    v=spf1 include:mailtank.ru redirect=_spf.maildomain.ru


DKIM
----
Технология DomainKeys Identified Mail (DKIM) объединяет несколько существующих методов антифишинга и антиспама с целью повышения качества классификации и идентификации легитимной электронной почты.

Вся почта, отправляемая Mailtank подписывается по технологии DKIM. По-умолчанию, Mailtank использует подпись домена mailtank.ru. В этом случае настройка Вашего домена не требуется. Если Вы хотите использовать Ваш домен в подписи, в настройках домена включите пункт "Подписывать письма DKIM записью с этим доменом" и выполните инструкцию по настройке.


Настройка DKIM записи домена
++++++++++++++++++++++++++++
В DNS записях Вашего домена нужно добавить "TXT" запись
`mailtank._domainkey.domain.com.`, где "domain.com" - Ваш домен.
TXT запись должна в точности совпадать со следующей строкой:

.. sourcecode:: txt

    "v=DKIM1; k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDinXUoxC0gpMKFc5IR9/h1FPJUHN6LS+Jps9bH9rfPDRnweyhnD9H90M41EtOJH4z6rj3m1" "cBEYc7+zm2am8W4pPhPjqamlBk9LF9SUKkp0hCoo36rpcgBpryeZCWoAkFFccgIsZ5Pt77KU0vcvWdqDtp3m5igkBvKfHDoCgYRAwIDAQAB"

